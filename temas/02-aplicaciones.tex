\documentclass[../VD.tex]{subfiles}

\externaldocument{../VD}

\begin{document}

\setcounter{chapter}{1}
\chapter{Aplicaciones diferenciables entre variedades}
\label{chap:app}

\section{Aplicaciones diferenciables}
\label{sec:app-dif}

\begin{definition}[diferenciable]
  \label{def:diferenciable}
  Sea \(f \colon M \to N\) una aplicación entre variedades. Decimos que \(f\) es
  \emph{diferenciable} en \(p \in M\) si para toda carta \((W,\psi)\) de \(N\)
  con \(f(p) \in W\) existe una carta \((U,\varphi)\) de \(M\) tal que \(p \in
  U, f(U) \subseteq W\) y \(\psi \circ f \circ \varphi^{-1} \colon \varphi(U)
  \to \psi(W)\) es diferenciable en \(\varphi(p)\). Nótese que, en la
  \cref{fig:factorizacion-diferenciable}, \(\widetilde{f} = \psi \circ f \circ
  \varphi^{-1}\).

  Se dice que \(f\) es \emph{diferenciable} si lo es para todo \(p \in M\).
\end{definition}

\begin{figure}[h]
  \centering
  \begin{tikzcd}
    U \arrow[r, "f"] \arrow[d, "\varphi"']
    & W \arrow[d, "\psi"] \\
    \varphi(U) \arrow[r, "\widetilde{f}"]
    & \psi(W)
  \end{tikzcd}
  \caption{Factorización de una aplicación diferenciable entre variedades}
  \label{fig:factorizacion-diferenciable}
\end{figure}

\begin{lemma}
  \label{lem:dif-implies-cont}
  Toda \(f\) \nameref{def:diferenciable} es continua para las topologías
  asociadas a las correspondientes estructuras diferenciables.
\end{lemma}

\begin{proof}
  Sea \(G \subset N\) abierto. Veamos que \(f^{-1}(G)\) es abierto de \(M\).

  Sea \(p \in f^{-1}(G)\). Entonces \(f(p) \in G\). Por el
  lema de \nameref{lem:topnat-caract}, existe
  \((W,\psi)\) carta de \(N\) con \(f(p) \in W \subseteq G\). Como \(f\) es
  \nameref{def:diferenciable} existe \((U,\varphi)\) carta de \(U\) con \(p \in
  U\), \(f(U) \subseteq W \subseteq G\). Entonces \(p \in U \subseteq
  f^{-1}(G)\). 
\end{proof}

\begin{lemma}
  Si \(f \colon M \to N\) y \(g \colon N \to Z\) son
  \hyperref[def:diferenciable]{diferenciables}, entonces \(g \circ f\) también
  lo es.
\end{lemma}

\begin{proof}
  Sean \(p \in M\) y \((\Omega,\rho)\) una carta de \(Z\) con \((g \circ f)(p)
  \in \Omega\). Como \(g\) es diferenciable, existe una carta \((W,\psi)\) de
  \(N\) con \(f(p) \in W\), \(g(W) \subseteq \Omega\) y \(\widetilde{g}
  \coloneqq \rho \circ g \circ \psi^{-1}\) diferenciable. Por otra parte, como
  \(f\) es diferenciable, existe una carta \((U,\varphi)\) de \(M\) con \(p \in
  U\), \(f(U) \subseteq W\) y \(\widetilde{f} \coloneqq \psi \circ f \circ
  \varphi^{-1}\) diferenciable. Tenemos el diagrama de la \cref{fig:comp-dif-cd}.

  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      U \ar[d, "\varphi"] \ar[r, "f"] &
      W \ar[d, "\psi"] \ar[r, "g"] &
      \Omega \ar[d, "\rho"]\\
      \varphi(U) \ar[r, "\widetilde{f}"] &
      \psi(W) \ar[r, "\widetilde{g}"] &
      \rho(\Omega)
    \end{tikzcd}
    \caption{Composición de aplicaciones diferenciables}
    \label{fig:comp-dif-cd}
  \end{figure}

  Ya hemos encontrado una carta \((U,\varphi)\) de \(M\) con \(p \in U\) y \((g
  \circ f)(U) \subseteq \Omega\).
  Para ver que \(g \circ f\) es diferenciable, queda probar que
  \(h \coloneqq \rho \circ g \circ f \circ \varphi^{-1}\) lo es, y resulta que
  \(h = \widetilde{g} \circ \widetilde{f}\), i.e. es composición de aplicaciones
  diferenciables (por hipótesis), luego es diferenciable.
\end{proof}

\begin{lemma}
  \(f\) es \nameref{def:diferenciable} en \(p\) si y solo si existen cartas
  \((U,\varphi)\) de \(M\) y \((W,\psi)\) de \(N\) con \(p \in U\), \(f(U)
  \subseteq W\) y \(\widetilde{f} = \psi \circ f \circ \varphi^{-1}\) es
  diferenciable (la misma de la \cref{fig:factorizacion-diferenciable}).
\end{lemma}

\begin{proof}\item
\begin{subproof}[\(\implies\)]
Es cierto pues que existan esas cartas es un caso particular de que \(f\) sea
diferenciable.
\end{subproof}
\begin{subproof}[\(\impliedby\)]
  Sea \((\Omega,\rho)\) carta cualquiera de \(N\) con \(f(p)\in\Omega\). Se
  tiene que \(\Omega\cap W\) es abierto de \(N\) y \(f(p) \in \Omega\cap
  W \subseteq W\). Como además \((W,\psi)\) y \((\Omega,\rho)\) son compatibles,
  entonces \(\psi(\Omega\cap W),\rho(\Omega\cap W)\) son abiertos y
  \(\psi\circ\rho^{-1},\rho\circ\psi^{-1}\) son diferenciables.

  Sabemos que \(f \colon U \to W\) es continua, y que \(W,\Omega\) son abiertos
  de \(N\) por lo que su intersección también, luego \(f^{-1}(\Omega \cap W)\)
  es abierto de \(M\), entonces \(f^{-1}(\Omega \cap W)\cap U \eqqcolon \Gamma
  \subseteq U\) es abierto de \(M\).

Sabemos por el \cref{lem:compat-restriccion}, que
\((\Gamma,\Restrict{\varphi}{\Gamma})\) es carta de \(M\). Entonces:

\[\Gamma\overset{f}{\rightarrow}\Omega\cap W\subseteq W,\Omega\]

\begin{figure}[h]
	\centering
	\begin{tikzcd}	
		\Gamma
		\arrow[rr,"	f "]
		\arrow[d, "\varphi"]&&
		\Omega
		\arrow[d, "\rho"]\\
		\varphi(\Gamma) \ar[d, symbol=\ni]
		\arrow[rr, "\tilde{f}=\rho\circ f\circ\varphi^{-1}"]&&
		\rho(\Omega)\\
    \varphi(p)
	\end{tikzcd}

Y \(\varphi(\Gamma)\) es abierto pues \(\varphi\) es homeomorfismo y \(\Gamma\) abierto.

Con el anterior diagrama y la definición que hemos hecho de
\(\tilde{f}=\rho\circ f\circ\varphi^{-1}=(\rho\circ\psi^{-1})\circ(\psi\circ
f\circ\varphi^{-1})\) que es diferenciable pues \((\rho\circ\psi^{-1})\) lo es
por compatbilidad y \((\psi\circ f\circ\varphi^{-1})\) lo es por hipótesis,
luego se tiene que \(f\) es diferenciable.

 
\end{figure}


\end{subproof}
\end{proof}

\begin{lemma}
  \label{lem:dif-caract-forall}
  Supongamos que \(f \colon M \to N\) es continua. Entonces \(f\) es
  \nameref{def:diferenciable} en \(p\) si y solo si para todas las cartas
  \((U,\varphi)\) de \(M\) y \((W,\psi)\) de \(N\) con \(p \in U\) y \(f(U)
  \subseteq W\), la aplicación \(\widetilde{f} \coloneqq \psi \circ f \circ
  \varphi^{-1}\) (la misma de la \cref{fig:factorizacion-diferenciable}) es
  diferenciable.
\end{lemma}

\begin{proof}\item 
\begin{subproof}[\(\impliedby\)]
  Sea \((W',\psi')\) una carta con \(f(p) \in W'\).
  Como \(W\) y \(W'\) son abiertos de \(N\), es claro que \(W \cap W'\) también
  es abierto de \(N\).
  Por ser \(f\) continua, \(f^{-1}(W\cap W')\) es abierto en \(M\),
  con \(p \in f^{-1}(W \cap W')\).

  Como \(U\) es abierto de \(M\) podemos definir el abierto \(U'\) de \(M\) como
  \(U \cap f^{-1}(W \cap W')\). Entonces \((U',\varphi')\) con \(\varphi'
  \coloneqq \Restrict{\varphi}{U'}\) es una carta de \(M\) por el
  \cref{lem:compat-subcartas} de \nameref{lem:compat-subcartas} y ser \(\varphi
  \colon U \to \varphi(U)\) homeomorfismo.

  Además \(p \in U'\) y \(f(U') \subseteq W' \).
  Finalmente

  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      U' \ar[r, "f"] \ar[d, "\varphi'"'] & W' \ar[d, "\psi'"]\\
      \varphi'(U') \ar[d, hook, "i_{U'}"']
      \ar[r, "\hat{f}"] & \psi'(W') \ar[d, hook, "i_{W'}"]\\
      \varphi(U) \ar[r, "\widetilde{f}"'] & \psi(W')
    \end{tikzcd}
  \end{figure}

  Por construcción de \((W',\psi')\) y definición de
  \nameref{def:diferenciable}, \(f\) es diferenciable si y solo si \(\hat{f} =
  \psi' \circ f \circ (\varphi')^{-1}\)
  lo es, y efectivamente lo es porque \(\hat{f} = \Restrict{\widetilde{f}\,}{\varphi(U')}\), que es
  restricción de una aplicación diferenciable luego es diferenciable (recordemos
  que \(\widetilde{f} = \psi \circ f \circ \varphi^{-1}\) es diferenciable
  por ser \(f\) diferenciable).
\end{subproof}

\begin{subproof}[\(\implies\)]
Para dos cartas \((U,\varphi)\) de \(M\) y \((W,\psi)\) de \(N\) con \(p\in U\)
y \(f(U)\subseteq W\), la composición \(\psi\circ f \circ \varphi^{-1}\) es
diferenciable por definición.
\end{subproof}
\end{proof}

\begin{corollary}
  Una aplicación \(f \colon M \to \RealSet\) es \nameref{def:diferenciable} si y
  solo si para cualquier carta \((U,\varphi)\) de \(M\), la aplicación \(f \circ
  \varphi^{-1} \colon \varphi(U) \subseteq \RealSet^{m} \to \RealSet\) es
  diferenciable.
\end{corollary}

\begin{proof}
  Basta usar la carta \((\RealSet, \Id{\RealSet})\) en
  \hyperref[lem:dif-caract-forall]{el lema anterior}, pues se tiene que
  \(\widetilde{f} = \Id{\RealSet} \circ f \circ \varphi^{-1} = f \circ
  \varphi^{-1}\).
\end{proof}

\section{Difeomorfismo}
\label{sec:difeo}

\begin{definition}[difeomorfismo]
  \label{def:difeo}
  \(f \colon M \to N\) se dice \emph{difeomorfismo} entre variedades si \(f\) es
  biyectiva y \(f\) y \(f^{-1}\) son \hyperref[def:diferenciable]{diferenciables}.
\end{definition}

\begin{lemma}
  Si \(f \colon M \to N\) es un \nameref{def:difeo} y \(\mathcal{A}\) y
  \(\mathcal{B}\) son atlas de \(M\) y \(N\) respectivamente, entonces
  \begin{equation}
    \tag{L2.5.1}
    \label{eq:atlas-difeo}
    f(\mathcal{A}) = \Set{
      (f(U), \varphi \circ f^{-1})
      :
      (U,\varphi) \in \mathcal{A}
    }
  \end{equation}
  es un \nameref{def:atlas} de \(N\) \hyperref[def:atlas-compat]{compatible} con
  \(\mathcal{B}\).
\end{lemma}

\begin{proof}\item
  \begin{subproof}[\(f(\mathcal{A})\) es atlas]
    \(f(\mathcal{A})\) es numerable y \((\varphi \circ f^{-1})(f(U)) =
    \varphi(U)\) es un abierto de \(\RealSet^{m}\). Además, si \(f(U) \cap f(V)
    = f(U \cap V) \neq \emptyset\) con \((U,\varphi), (V,\psi) \in
    \mathcal{A}\), entonces
    \[
      (\psi \circ f^{-1}) \circ (\varphi \circ f^{-1})^{-1} = \psi \circ f^{-1}
      \circ f \circ \varphi^{-1} = \psi \circ \varphi^{-1}
    \]
    que va de \((\varphi \circ f^{-1})(f(U \cap V)) = \varphi(U \cap V)\) a
    \(\psi(U \cap V) = (\psi \circ f^{-1})(f(U \cap V))\), y es diferenciable
    por hipótesis, luego todas las cartas de \(f(\mathcal{A})\) es compatibles
    entre sí.
  \end{subproof}

  \begin{subproof}[\(f(\mathcal{A})\) es compatible con \(\mathcal{B}\)]
    Sean \((f(U), \varphi f^{-1}) \in f(\mathcal{A})\) y \((W,\rho) \in
    \mathcal{B}\) con \(f(U) \cap W \neq \emptyset\). Tenemos que ver que
    \[
      \rho \circ (\varphi \circ f^{-1})^{-1}
      \colon
      \varphi f^{-1}(f(U) \cap W)
      \to
      \rho(f(U) \cap W)
    \]
    es diferenciable. Nótese que \(\rho \circ (\varphi \circ f^{-1})^{-1} = \rho
    \circ f \circ \varphi^{-1}\). Para ello, sea \(x \in \varphi f^{-1}(f(U)
    \cap W) = \varphi(U \cap f^{-1}(W))\). Sea \(p \in U \cap f^{-1}(W)\) con
    \(x = \varphi(p)\).

    Por ser \(f\) diferenciable, también es continua por el
    \cref{lem:dif-implies-cont} y \(\Omega \coloneqq U \cap f^{-1}(W)\) es
    abierto de \(M\). Tenemos que \(f(\Omega) \subseteq W\). Como \(f\) es
    diferenciable en \(p\), para la carta \((\Omega, \varphi_{0})\) con
    \(\varphi_{0} \coloneqq \Restrict{\varphi}{\Omega}\), la composición \(\rho
    \circ f \circ \varphi_{0}^{-1} \colon \varphi_{0}(\Omega) \to \rho(W)\) es
    diferenciable. Como \(\varphi_{0}(\Omega) = \varphi(\Omega)\) es abierto de
    \(\varphi(U)\), tenemos que \(\rho \circ f \circ \varphi^{-1}\) es
    diferenciable en todos sus puntos.

    Análogamente, como \(f^{-1}\) es diferenciable se tiene que \(\varphi \circ
    f^{-1} \circ \rho^{-1} \colon \rho(f(U) \cap W) \to \varphi f^{-1}(f(U) \cap
    W)\) es diferenciable.
  \end{subproof}
\end{proof}

\begin{note}
  la primera parte prueba que si tenemos \(\mathcal{A}\) un atlas sobre \(M\) y
  \(f \colon M \to X\) es una biyección (con \(X\) un conjunto cualquiera),
  entonces \(X\) puede verse dotado de una estructura diferenciable con atlas
  \(f(\mathcal{A})\) que cumple las siguientes propiedades:

  \begin{enumerate}
  \item Una carta \((\Omega,\xi)\) es compatible con \(f(\mathcal{A})\) si y
    solo si la carta \((f^{-1}(\Omega), \xi \circ f)\) es compatible con
    \(\mathcal{A}\). De aquí se sigue la \nameref{def:Hausdorff} para la
    estructura inducida por \(f(\mathcal{A})\).
  \item \(f\) se convierte en un \nameref{def:difeo}.
  \end{enumerate}
\end{note}

\section{Derivadas parciales}
\label{sec:partial}

\begin{definition}
  Llamamos \(\Fdif{U}\) al conjunto de funciones (infinitamente)
  diferenciables del tipo \(f \colon U \to \RealSet\), i.e. \(\Fdif{U}
  \coloneqq C^{\infty}(U; \RealSet)\).
\end{definition}

Para cada carta \((U,\varphi)\), si vemos \(U\) como variedad, existen funciones
\(\Fdif{U}\): exactamente las funciones coordenadas de \(\varphi\), i.e. si
\(\varphi \colon U \to \varphi(U) \subseteq \RealSet^{n}\) y escribimos
\(\varphi(p) = (x_{1}(p),\dots,x_{n}(p))\), entonces \(x_{i} \in \Fdif{U}\). En
efecto, \(x_{i} \colon U \to \RealSet\) es diferenciable porque para una carta
relativa a \(U\), \((W \cap U, \Restrict{\psi}{W \cap U})\), tenemos que
\[
  x_{i} \circ \left( \Restrict{\psi}{W \cap U} \right)^{-1} \colon
  \psi(W \cap U) \to \varphi(W \cap U) \to \RealSet
\]
es diferenciable por serlo el cambio de carta.

\begin{definition}[derivada parcial]
  A partir de las \(x_{1},\dots,x_{n}\) anteriores, se definen unos operadores
  locales para cada carta \((U,\varphi)\), que son las \emph{derivadas
    parciales}:
  \[
    \pderiv{}{x_{i}} \colon \Fdif{U} \to \Fdif{U}
  \]
\end{definition}

\begin{definition}[derivada parcial en un punto]
  \(\pderiv{}{x_{i}}\) es un operador que actúa sobre funciones, luego
  \(\pderiv{}{x_{i}}(f) \colon U \to \RealSet\), así que podemos considerar
  aplicar esta función en un punto \(p \in U\). Usaremos la siguiente notación:
  \[
    \pderiv{}{x_{i}}(f)(p) \eqqcolon \left( \pderiv{f}{x_{i}} \right)_{p}
    = \pderiv{(f \circ \varphi^{-1})}{u_{i}}(\varphi(p))
    \eqqcolon \Restrict{\pderiv{(f \circ \varphi^{-1})}{u_{i}}}{\varphi(p)}
  \]
\end{definition}

\begin{lemma}
  \(\pderiv{}{x_{i}}\) está bien definido.
\end{lemma}

\begin{proof}
  Si \((W,\psi)\) es una carta de \(M\), hay que comprobar que la composición
  \(\pderiv{f}{x_{i}} \circ \Restrict{\psi^{-1}}{W \cap U}\) sea diferenciable.

  Sea \(q \in \psi(W \cap U)\). Entonces
  \begin{align*}
    \pderiv{f}{x_{i}}(\psi^{-1}(q))
    &= \pderiv{(f \circ \varphi^{-1})}{u_{i}}(\varphi \psi^{-1}(q))\\
    &= \pderiv{(f \circ \varphi^{-1})}{u_{i}} \circ \Restrict{(\varphi \circ \psi^{-1})}{U \cap W}
  \end{align*}
  que es diferenciable.
\end{proof}

\begin{note}
  Si \((U,\varphi)\) es una carta y \(U' \subseteq U\) es un abierto, tenemos
  una proyección:
  \begin{align*}
    \rho_{UU'} \colon \Fdif{U} &\mapsto \Fdif{U'}\\
    f &\mapsto \Restrict{f}{U'}
  \end{align*}

  Si tomamos \(\varphi' = \Restrict{\varphi}{U'}\), entonces para la carta
  \((U',\varphi')\), el operador
  \[
    \pderiv{}{x_{i}} \colon \Fdif{U'} \to \Fdif{U'}
  \]
  está definido como el operador
  \[
    \pderiv{}{x_{i}} \colon \Fdif{U} \to \Fdif{U}
  \]
\end{note}

Sean ahora \((U,\varphi)\) y \((W,\psi)\) dos cartas compatibles y consideremos
las cartas restringidas a la intersección \((U \cap W, \Restrict{\varphi}{U \cap
W})\) y \((W \cap U, \Restrict{\psi}{U \cap W})\). Si
\(y_{1},\dots,y_{n}\) denotan las funciones coordenadas de \(\psi\), ¿qué
relación hay entre los operadores \(
\pderiv{}{x_{i}}, \pderiv{}{y_{i}} \colon \Fdif{U \cap W} \to \Fdif{U \cap W}
\)?

Para \(f \in \Fdif{U \cap W}\), tenemos
\[
  \Restrict{\pderiv{f}{y_{i}}}{p}
  = \Restrict{\pderiv{(f \circ \psi^{-1})}{w_{i}}}{\psi(p)}
\]
donde \(w_{i}\) son las coordenadas de \(\psi(W)\).
\[
  \Restrict{\pderiv{f}{x_{i}}}{p}
  = \Restrict{\pderiv{(f \circ \varphi^{-1})}{u_{i}}}{\varphi(p)}
\]
donde \(u_{i}\) son las coordenadas de \(\varphi(U)\).

Ahora tomamos \(\varphi \circ \psi^{-1}(w_{1}, \dots, w_{n})\) (cambio de
variable). La regla de la cadena nos da
\[
  \Restrict{\pderiv{
      ((f \circ \varphi^{-1}) \circ \varphi \circ \psi^{-1})
    }{w_{i}}}{\psi(p)}
  =
  \Sum{
    \Restrict{\pderiv{(f \circ \varphi^{-1})}{u_{j}}}{\varphi(p)}
    \cdot
    \Restrict{\pderiv{(\varphi \circ \psi^{-1})_{j}}{w_{i}}}{\psi(p)}
  }{j,1,n}
\]

Ahora veremos cómo el cálculo en varias variables se extiende a las aplicaciones
diferenciables entre variedades.

\begin{definition}[rango]
  Sea \(f \colon M \to N\) una aplicación diferenciable en \(p \in M\). Por ser
  \(f\) diferenciable, podemos encontrar cartas \((U,\varphi)\) y \((W,\psi)\)
  de \(M\) y \(N\) respectivamente con \(p \in U\), \(f(U) \subseteq W\) y
  \(\psi \circ f \circ \varphi^{-1} \colon \varphi(U) \to \psi(W)\)
  diferenciable en \(\varphi(p)\).

  Se llama \emph{rango} de \(f\) en \(p\), notado \(\rango{f(p)}\), al rango del
  determinante de la matriz jacobiana \(n \times m\) (se trabaja por columnas),

  \begin{equation}
    \label{eq:def-rango}
    \J[\varphi(p)]{\psi f \varphi^{-1}} =
    \left(
      \Restrict{\pderiv{(\psi \circ f \circ \varphi^{-1})_{i}}{x_{j}}}{\varphi(p)}
    \right)_{\substack{1 \leq i \leq n\\\\1 \leq j \leq m}}
  \end{equation}
\end{definition}

\begin{note}
  Este rango no depende de las cartas usadas.
\end{note}

\begin{proof}
  Si \((\Omega,\rho)\) y \((V,\xi)\) son otras cartas con \(p \in \Omega\),
  \(f(\Omega) \subseteq V\) y \(\xi \circ f \circ \rho^{-1}\) diferenciable en
  \(\rho(p)\), entonces \(f(\Omega \cap U) \subseteq V \cap W\) y, por
  compatibilidad,

  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      \varphi(U) \ar[rr, "\psi \circ f \circ \varphi^{-1}"] &&
      \psi(W) \\
      \varphi(\Omega \cap U) \ar[u, symbol=\subseteq] \ar[rr, "\psi \circ f \circ
      \varphi^{-1}"] \ar[d, "\rho \circ \varphi^{-1}"'] &&
      \psi(W \cap V) \ar[u, symbol=\subseteq] \ar[d, "\xi \circ \psi^{-1}"]\\
      \rho(\Omega \cap U) \ar[rr, "\xi \circ f \circ \rho^{-1}"] \ar[d,
      symbol=\subseteq] &&
      \xi(W \cap V) \ar[d, symbol=\subseteq]\\
      \rho(\Omega) \ar[rr, "\xi \circ f \circ \rho^{-1}"] &&
      \xi(V)
    \end{tikzcd}
    \caption{Cambio de cartas}
    \label{fig:rango-indep-carta}
  \end{figure}

  % TODO
\end{proof}

\section{Inmersiones}
\label{sec:inmersion}

\begin{definition}[inmersión]
  \label{def:inmersión}
  Una aplicación diferenciable \(f \colon M \to N\) se dice que es una
  \emph{inmersión} en \(p \in M\) si \(\rango{f(p)} = \dim M\). Igualmente se
  dice una \emph{submersión} en \(p\) si \(\rango{f(p)} = \dim N\).
\end{definition}

\begin{note}
  Si \(f\) es \emph{inmersión} en \(p\), entonces \(\dim M \leq \dim N\). Si
  \(f\) es \emph{submersión}en \(p\), entonces \(\dim N \leq \dim M\).
\end{note}

\begin{theorem}
  Si \(f\) es una \nameref{def:inmersión} en \(p\), entonces existen cartas
  \((U,\varphi)\) de \(p\) y \((V,\psi)\) de \(f(p)\) verificando el diagrama
  conmutativo de la \cref{fig:inmersion-cd}, con \(m =
  \dim M\) y \(n = \dim N\). Es decir, realmente \(f\) se comporta alrededor de
  \(p\)como la inclusión canónica \(x \mapsto (x,0)\).

  \begin{figure}[h]
    \centering
    \begin{tikzcd}[column sep = large, row sep = scriptsize]
      U \ar[r, "f"] \ar[d, "\varphi"']&
      V \ar[d, "\psi"]\\
      \varphi(U) \ar[r, dashed, "\psi \circ f \circ \varphi^{-1}"']
      \ar[d, symbol=\subseteq]&
      \psi(V)
      \ar[d, symbol=\subseteq]\\
      \RealSet^{m} \ar[r, hook]&
      \RealSet^{n} = \RealSet^{m} \times \RealSet^{n-m}%
      \nphantom{\(= \RealSet^{m} \times \RealSet^{n-m}\)}\\
      x \ar[r, mapsto] & (x,0)
    \end{tikzcd}
    \caption{Inmersión}
    \label{fig:inmersion-cd}
  \end{figure}
\end{theorem}

\begin{proof}
  De acuerdo con el \cref{lem:dif-caract-forall} % CHECK,
  podemos elegir cartas \((U,\varphi)\) y \((V,\psi)\) con \(p \in U\) y \(f(U)
  \subseteq V\). Podemos suponer que \(\varphi(p)=0=\psi(f(p))\). Ahora
  consideramos \(\widetilde{f} = \psi \circ f \circ \varphi^{-1}\), la misma de
  la \cref{fig:factorizacion-diferenciable}.

  Si \(f\) es una \nameref{def:inmersión} en \(p\), entonces \(\rango{f(p)} =
  m\). Elegimos \(i_{1},\dots,i_{m} \in \Set{1,\dots,n}\) tales que el menor \(m
  \times m\) de la matriz jacobiana \(\left( \pderiv{\widetilde{f}_{i}}{x_{j}}
  \right)\) tiene determinante no nulo.

  \[
    \J[1]{\widetilde{f}} =
    \begin{pmatrix}
      \pderiv{\widetilde{f}_{i_{1}}}{x_{1}} & \cdots &
      \pderiv{\widetilde{f}_{i_{1}}}{x_{m}}\\
      \vdots & \ddots & \vdots\\
      \pderiv{\widetilde{f}_{i_{m}}}{x_{1}} & \cdots &
      \pderiv{\widetilde{f}_{i_{m}}}{x_{m}}
    \end{pmatrix}
  \]

  Con el fin de simplificar la notación podemos suponer \(i_{k} = k\) para todo
  \(1 \leq k \leq m\). Si no, hacemos una permutación de coordenadas en
  \(\RealSet^{n}\) adecuada y la componemos con \(\psi\) para crear una carta
  con la propiedad deseada.

  Ahora consideramos una nueva función
  \(\widetilde{F} \colon \underbracket{\varphi(U)}_{\subseteq \RealSet^{m}}
  \times \RealSet^{n-m}\) dada por
  \begin{multline*}
    \widetilde{F}(x_{1},\dots,x_{m},y_{1},\dots,y_{n-m}) =
    (\widetilde{f}_{1}(x),\dots,\widetilde{f}_{m}(x),\\
    \widetilde{f}_{m+1}(x)+y_{1},\dots,
    \widetilde{f}_{n}(x)+y_{n-m})
  \end{multline*}
  
  Entonces el jacobiano de \(\widetilde{F}\) es
  \[
    \J{\widetilde{F}} =
    \begin{pmatrix}
      \J[1]{\widetilde{F}} & 0 \\
      \J[2]{\widetilde{F}} & I
    \end{pmatrix}
  \]
  donde \(\J[2]{\widetilde{F}}\) está formado por
  \(\pderiv{\widetilde{f}_{i}}{x_{j}}\) con \(m+1 \leq i \leq n\) y \(1 \leq j
  \leq m\).
\end{proof}

\end{document}

%%% Local Variables:
%%% TeX-master: "../VD"
%%% End: