\documentclass[../VD.tex]{subfiles}

\externaldocument{../VD}

\begin{document}

\setcounter{chapter}{1}
\chapter{Aplicaciones diferenciables entre variedades}
\label{chap:app}

\section{Aplicaciones diferenciables}
\label{sec:app-dif}

\begin{definition}[diferenciable]
  \label{def:diferenciable}
  Sea \(f \colon M \to N\) una aplicación entre variedades. Decimos que \(f\) es
  \emph{diferenciable} en \(p \in M\) si para toda carta \((W,\psi)\) de \(N\)
  con \(f(p) \in W\) existe una carta \((U,\varphi)\) de \(M\) tal que \(p \in
  U, f(U) \subseteq W\) y \(\psi \circ f \circ \varphi^{-1} \colon \varphi(U)
  \to \psi(W)\) es diferenciable en \(\varphi(p)\). Nótese que, en la
  \cref{fig:factorizacion-diferenciable}, \(\widetilde{f} = \psi \circ f \circ
  \varphi^{-1}\).

  Se dice que \(f\) es \emph{diferenciable} si lo es para todo \(p \in M\).
\end{definition}

\begin{figure}[h]
  \centering
  \begin{tikzcd}
    U \arrow[r, "f"] \arrow[d, "\varphi"']
    & W \arrow[d, "\psi"] \\
    \varphi(U) \arrow[r, "\widetilde{f}"]
    & \psi(W)
  \end{tikzcd}
  \caption{Factorización de una aplicación diferenciable entre variedades}
  \label{fig:factorizacion-diferenciable}
\end{figure}

\begin{lemma}
  \label{lem:dif-implies-cont}
  Toda \(f\) \nameref{def:diferenciable} es continua para las topologías
  asociadas a las correspondientes estructuras diferenciables.
\end{lemma}

\begin{proof}
  Sea \(G \subset N\) abierto. Veamos que \(f^{-1}(G)\) es abierto de \(M\).

  Sea \(p \in f^{-1}(G)\). Entonces \(f(p) \in G\). Por el
  lema de \nameref{lem:topnat-caract}, existe
  \((W,\psi)\) carta de \(N\) con \(f(p) \in W \subseteq G\). Como \(f\) es
  \nameref{def:diferenciable} existe \((U,\varphi)\) carta de \(U\) con \(p \in
  U\), \(f(U) \subseteq W \subseteq G\). Entonces \(p \in U \subseteq
  f^{-1}(G)\). 
\end{proof}

\begin{lemma}
  Si \(f \colon M \to N\) y \(g \colon N \to Z\) son
  \hyperref[def:diferenciable]{diferenciables}, entonces \(g \circ f\) también
  lo es.
\end{lemma}

\begin{proof}
  Sean \(p \in M\) y \((\Omega,\rho)\) una carta de \(Z\) con \((g \circ f)(p)
  \in \Omega\). Como \(g\) es diferenciable, existe una carta \((W,\psi)\) de
  \(N\) con \(f(p) \in W\), \(g(W) \subseteq \Omega\) y \(\widetilde{g}
  \coloneqq \rho \circ g \circ \psi^{-1}\) diferenciable. Por otra parte, como
  \(f\) es diferenciable, existe una carta \((U,\varphi)\) de \(M\) con \(p \in
  U\), \(f(U) \subseteq W\) y \(\widetilde{f} \coloneqq \psi \circ f \circ
  \varphi^{-1}\) diferenciable. Tenemos el diagrama de la \cref{fig:comp-dif-cd}.

  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      U \ar[d, "\varphi"] \ar[r, "f"] &
      W \ar[d, "\psi"] \ar[r, "g"] &
      \Omega \ar[d, "\rho"]\\
      \varphi(U) \ar[r, "\widetilde{f}"] &
      \psi(W) \ar[r, "\widetilde{g}"] &
      \rho(\Omega)
    \end{tikzcd}
    \caption{Composición de aplicaciones diferenciables}
    \label{fig:comp-dif-cd}
  \end{figure}

  Ya hemos encontrado una carta \((U,\varphi)\) de \(M\) con \(p \in U\) y \((g
  \circ f)(U) \subseteq \Omega\).
  Para ver que \(g \circ f\) es diferenciable, queda probar que
  \(h \coloneqq \rho \circ g \circ f \circ \varphi^{-1}\) lo es, y resulta que
  \(h = \widetilde{g} \circ \widetilde{f}\), i.e.\ es composición de aplicaciones
  diferenciables (por hipótesis), luego es diferenciable.
\end{proof}

\begin{lemma}
  \label{lem:dif-caract-exists}
  \(f\) es \nameref{def:diferenciable} en \(p\) si y solo si existen cartas
  \((U,\varphi)\) de \(M\) y \((W,\psi)\) de \(N\) con \(p \in U\), \(f(U)
  \subseteq W\) y \(\widetilde{f} = \psi \circ f \circ \varphi^{-1}\) es
  diferenciable (la misma de la \cref{fig:factorizacion-diferenciable}).
\end{lemma}

\begin{proof}\item
\begin{subproof}[\(\implies\)]
Es cierto pues que existan esas cartas es un caso particular de que \(f\) sea
diferenciable.
\end{subproof}
\begin{subproof}[\(\impliedby\)]
  Sea \((\Omega,\rho)\) carta cualquiera de \(N\) con \(f(p)\in\Omega\). Se
  tiene que \(\Omega\cap W\) es abierto de \(N\) y \(f(p) \in \Omega\cap
  W \subseteq W\). Como además \((W,\psi)\) y \((\Omega,\rho)\) son compatibles,
  entonces \(\psi(\Omega\cap W),\rho(\Omega\cap W)\) son abiertos y
  \(\psi\circ\rho^{-1},\rho\circ\psi^{-1}\) son diferenciables.

  Sabemos que \(f \colon U \to W\) es continua, y que \(W,\Omega\) son abiertos
  de \(N\) por lo que su intersección también, luego \(f^{-1}(\Omega \cap W)\)
  es abierto de \(M\), entonces \(f^{-1}(\Omega \cap W)\cap U \eqqcolon \Gamma
  \subseteq U\) es abierto de \(M\).

Sabemos por el \cref{lem:compat-restriccion}, que
\((\Gamma,\Restrict{\varphi}{\Gamma})\) es carta de \(M\). Entonces:

\[\Gamma\overset{f}{\rightarrow}\Omega\cap W\subseteq W,\Omega\]

\begin{figure}[h]
	\centering
	\begin{tikzcd}	
		\Gamma
		\arrow[rr,"	f "]
		\arrow[d, "\varphi"]&&
		\Omega
		\arrow[d, "\rho"]\\
		\varphi(\Gamma) \ar[d, symbol=\ni]
		\arrow[rr, "\tilde{f}=\rho\circ f\circ\varphi^{-1}"]&&
		\rho(\Omega)\\
    \varphi(p)
	\end{tikzcd}

Y \(\varphi(\Gamma)\) es abierto pues \(\varphi\) es homeomorfismo y \(\Gamma\) abierto.

Con el anterior diagrama y la definición que hemos hecho de
\(\tilde{f}=\rho\circ f\circ\varphi^{-1}=(\rho\circ\psi^{-1})\circ(\psi\circ
f\circ\varphi^{-1})\) que es diferenciable pues \((\rho\circ\psi^{-1})\) lo es
por compatbilidad y \((\psi\circ f\circ\varphi^{-1})\) lo es por hipótesis,
luego se tiene que \(f\) es diferenciable.

 
\end{figure}

\end{subproof}
\end{proof}

\begin{lemma}
  \label{lem:dif-caract-forall}
  Supongamos que \(f \colon M \to N\) es continua. Entonces \(f\) es
  \nameref{def:diferenciable} en \(p\) si y solo si para todas las cartas
  \((U,\varphi)\) de \(M\) y \((W,\psi)\) de \(N\) con \(p \in U\) y \(f(U)
  \subseteq W\), la aplicación \(\widetilde{f} \coloneqq \psi \circ f \circ
  \varphi^{-1}\) (la misma de la \cref{fig:factorizacion-diferenciable}) es
  diferenciable.
\end{lemma}

\begin{proof}\item 
\begin{subproof}[\(\impliedby\)]
  Sea \((W',\psi')\) una carta con \(f(p) \in W'\).
  Como \(W\) y \(W'\) son abiertos de \(N\), es claro que \(W \cap W'\) también
  es abierto de \(N\).
  Por ser \(f\) continua, \(f^{-1}(W\cap W')\) es abierto en \(M\),
  con \(p \in f^{-1}(W \cap W')\).

  Como \(U\) es abierto de \(M\) podemos definir el abierto \(U'\) de \(M\) como
  \(U \cap f^{-1}(W \cap W')\). Entonces \((U',\varphi')\) con \(\varphi'
  \coloneqq \Restrict{\varphi}{U'}\) es una carta de \(M\) por el
  \cref{lem:compat-subcartas} de \nameref{lem:compat-subcartas} y ser \(\varphi
  \colon U \to \varphi(U)\) homeomorfismo.

  Además \(p \in U'\) y \(f(U') \subseteq W' \).
  Finalmente

  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      U' \ar[r, "f"] \ar[d, "\varphi'"'] & W' \ar[d, "\psi'"]\\
      \varphi'(U') \ar[d, hook, "i_{U'}"']
      \ar[r, "\hat{f}"] & \psi'(W') \ar[d, hook, "i_{W'}"]\\
      \varphi(U) \ar[r, "\widetilde{f}"'] & \psi(W')
    \end{tikzcd}
  \end{figure}

  Por construcción de \((W',\psi')\) y definición de
  \nameref{def:diferenciable}, \(f\) es diferenciable si y solo si \(\hat{f} =
  \psi' \circ f \circ {(\varphi')}^{-1}\)
  lo es, y efectivamente lo es porque \(\hat{f} = \Restrict{\widetilde{f}\,}{\varphi(U')}\), que es
  restricción de una aplicación diferenciable luego es diferenciable (recordemos
  que \(\widetilde{f} = \psi \circ f \circ \varphi^{-1}\) es diferenciable
  por ser \(f\) diferenciable).
\end{subproof}

\begin{subproof}[\(\implies\)]
Para dos cartas \((U,\varphi)\) de \(M\) y \((W,\psi)\) de \(N\) con \(p\in U\)
y \(f(U)\subseteq W\), la composición \(\psi\circ f \circ \varphi^{-1}\) es
diferenciable por definición.
\end{subproof}
\end{proof}

\begin{corollary}
  Una aplicación \(f \colon M \to \RealSet\) es \nameref{def:diferenciable} si y
  solo si para cualquier carta \((U,\varphi)\) de \(M\), la aplicación \(f \circ
  \varphi^{-1} \colon \varphi(U) \subseteq \RealSet^{m} \to \RealSet\) es
  diferenciable.
\end{corollary}

\begin{proof}
  Basta usar la carta \((\RealSet, \Id{\RealSet})\) en
  \hyperref[lem:dif-caract-forall]{el lema anterior}, pues se tiene que
  \(\widetilde{f} = \Id{\RealSet} \circ f \circ \varphi^{-1} = f \circ
  \varphi^{-1}\).
\end{proof}

\section{Difeomorfismo}
\label{sec:difeo}

\begin{definition}[difeomorfismo]
  \label{def:difeo}
  \(f \colon M \to N\) se dice \emph{difeomorfismo} entre variedades si \(f\) es
  biyectiva y \(f\) y \(f^{-1}\) son \hyperref[def:diferenciable]{diferenciables}.
\end{definition}

\begin{lemma}
  Si \(f \colon M \to N\) es un \nameref{def:difeo} y \(\mathcal{A}\) y
  \(\mathcal{B}\) son atlas de \(M\) y \(N\) respectivamente, entonces
  \begin{equation}
    \tag{L2.5.1}
    \label{eq:atlas-difeo}
    f(\mathcal{A}) = \Set{
      (f(U), \varphi \circ f^{-1})
      :
      (U,\varphi) \in \mathcal{A}
    }
  \end{equation}
  es un \nameref{def:atlas} de \(N\) \hyperref[def:atlas-compat]{compatible} con
  \(\mathcal{B}\).
\end{lemma}

\begin{proof}\item
  \begin{subproof}[\(f(\mathcal{A})\) es atlas]
    \(f(\mathcal{A})\) es numerable y \((\varphi \circ f^{-1})(f(U)) =
    \varphi(U)\) es un abierto de \(\RealSet^{m}\). Además, si \(f(U) \cap f(V)
    = f(U \cap V) \neq \emptyset\) con \((U,\varphi), (V,\psi) \in
    \mathcal{A}\), entonces
    \[
      (\psi \circ f^{-1}) \circ {(\varphi \circ f^{-1})}^{-1} = \psi \circ f^{-1}
      \circ f \circ \varphi^{-1} = \psi \circ \varphi^{-1}
    \]
    que va de \((\varphi \circ f^{-1})(f(U \cap V)) = \varphi(U \cap V)\) a
    \(\psi(U \cap V) = (\psi \circ f^{-1})(f(U \cap V))\), y es diferenciable
    por hipótesis, luego todas las cartas de \(f(\mathcal{A})\) es compatibles
    entre sí.
  \end{subproof}

  \begin{subproof}[\(f(\mathcal{A})\) es compatible con \(\mathcal{B}\)]
    Sean \((f(U), \varphi f^{-1}) \in f(\mathcal{A})\) y \((W,\rho) \in
    \mathcal{B}\) con \(f(U) \cap W \neq \emptyset\). Tenemos que ver que
    \[
      \rho \circ {(\varphi \circ f^{-1})}^{-1}
      \colon
      \varphi f^{-1}(f(U) \cap W)
      \to
      \rho(f(U) \cap W)
    \]
    es diferenciable. Nótese que \(\rho \circ {(\varphi \circ f^{-1})}^{-1} = \rho
    \circ f \circ \varphi^{-1}\). Para ello, sea \(x \in \varphi f^{-1}(f(U)
    \cap W) = \varphi(U \cap f^{-1}(W))\). Sea \(p \in U \cap f^{-1}(W)\) con
    \(x = \varphi(p)\).

    Por ser \(f\) diferenciable, también es continua por el
    \cref{lem:dif-implies-cont} y \(\Omega \coloneqq U \cap f^{-1}(W)\) es
    abierto de \(M\). Tenemos que \(f(\Omega) \subseteq W\). Como \(f\) es
    diferenciable en \(p\), para la carta \((\Omega, \varphi_{0})\) con
    \(\varphi_{0} \coloneqq \Restrict{\varphi}{\Omega}\), la composición \(\rho
    \circ f \circ \varphi_{0}^{-1} \colon \varphi_{0}(\Omega) \to \rho(W)\) es
    diferenciable. Como \(\varphi_{0}(\Omega) = \varphi(\Omega)\) es abierto de
    \(\varphi(U)\), tenemos que \(\rho \circ f \circ \varphi^{-1}\) es
    diferenciable en todos sus puntos.

    Análogamente, como \(f^{-1}\) es diferenciable se tiene que \(\varphi \circ
    f^{-1} \circ \rho^{-1} \colon \rho(f(U) \cap W) \to \varphi f^{-1}(f(U) \cap
    W)\) es diferenciable.
  \end{subproof}
\end{proof}

\begin{note}
  la primera parte prueba que si tenemos \(\mathcal{A}\) un atlas sobre \(M\) y
  \(f \colon M \to X\) es una biyección (con \(X\) un conjunto cualquiera),
  entonces \(X\) puede verse dotado de una estructura diferenciable con atlas
  \(f(\mathcal{A})\) que cumple las siguientes propiedades:

  \begin{enumerate}
  \item Una carta \((\Omega,\xi)\) es compatible con \(f(\mathcal{A})\) si y
    solo si la carta \((f^{-1}(\Omega), \xi \circ f)\) es compatible con
    \(\mathcal{A}\). De aquí se sigue la \nameref{def:Hausdorff} para la
    estructura inducida por \(f(\mathcal{A})\).
  \item \(f\) se convierte en un \nameref{def:difeo}.
  \end{enumerate}
\end{note}

\section{Funciones reales}
\label{sec:partial}

\begin{definition}
  Llamamos \(\Fdif{U}\) al conjunto de funciones (infinitamente)
  diferenciables del tipo \(f \colon U \to \RealSet\), i.e. \(\Fdif{U}
  \coloneqq C^{\infty}(U; \RealSet)\).
\end{definition}

\begin{definition}[función coordenada]
  Sea \((U,\varphi)\) carta de \(M\). Consideramos el diagrama de la
  \cref{fig:fact-coord}.

  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      U \ar[r,"\varphi"] \ar[dr, "x_{i}"'] &
      \varphi(U) \ar[r, symbol=\subseteq] \ar[d, "\pi_{i}"] & \RealSet^{m}\\
      & \RealSet
    \end{tikzcd}
    \caption{Función coordenada}
    \label{fig:fact-coord}
  \end{figure}

  Consideramos la función \(x_{i} \colon U \to \RealSet\), que actúa de la
  siguiente forma:
  \[
    p \mapsto (\varphi_{i}(p), \dots, \varphi_{m}(p)) \mapsto \varphi_{i}(p)
  \]
  
  A esta función se le llama \emph{función coordenada} de la carta
  \((U,\varphi)\).
\end{definition}

\begin{proposition}
  Dada una carta \((U,\varphi)\), si vemos \(U\) como variedad, las funciones
  coordenadas de \(\varphi\) son diferenciables, i.e. \(x_{i} \in \Fdif{U},\ i=1,\dots,m\).
\end{proposition}

\begin{proof}
  Para una carta relativa a \(U\), \((W \cap U, \Restrict{\psi}{W \cap U})\),
  tenemos que
\[
  x_{i} \circ {\left( \Restrict{\psi}{W \cap U} \right)}^{-1} \colon
  \psi(W \cap U) \to \varphi(W \cap U) \to \RealSet
\]
es diferenciable por serlo el cambio de carta.
\end{proof}

\begin{definition}[derivada parcial]
Sea \(\pderiv{}{x_{i}} \colon \mathcal{F}(U)\to\mathcal{F}(U)\), \(1 \leq i\leq
m \coloneqq \dim{M}\), con \((U,\varphi)\) carta de \(M\), el operador tal
que si \(f \in \mathcal{F}(U),\ p\in U\), entonces:
\[
\Restrict{\pderiv{f}{x_{i}}}{p}=\Restrict{\pderiv{f\circ\varphi^{-1}}{x_{i}}}{\varphi(p)}
\in \RealSet
\]
\end{definition}

\begin{lemma}
  \(\pderiv{}{x_{i}}\) está bien definido.
\end{lemma}

\begin{proof}
  Si \((W,\psi)\) es una carta de \(M\), hay que comprobar que la composición
  \(\pderiv{f}{x_{i}} \circ \Restrict{\psi^{-1}}{W \cap U}\) sea diferenciable.

  Sea \(q \in \psi(W \cap U)\). Entonces
  \begin{align*}
    \pderiv{f}{x_{i}}(\psi^{-1}(q))
    &= \pderiv{(f \circ \varphi^{-1})}{u_{i}}(\varphi \psi^{-1}(q))\\
    &= \pderiv{(f \circ \varphi^{-1})}{u_{i}} \circ \Restrict{(\varphi \circ \psi^{-1})}{U \cap W}
  \end{align*}
  que es diferenciable.
\end{proof}

\begin{note}
  Si \((U,\varphi)\) es una carta y \(U' \subseteq U\) es un abierto, tenemos
  una aplicación:
  \begin{align*}
    \rho_{UU'} \colon \Fdif{U} &\to \Fdif{U'}\\
    f &\mapsto \Restrict{f}{U'}
  \end{align*}

  Si tomamos \(\varphi' = \Restrict{\varphi}{U'}\), entonces para la carta
  \((U',\varphi')\), el operador
  \[
    \pderiv{}{x_{i}} \colon \Fdif{U'} \to \Fdif{U'}
  \]
  está definido como el operador
  \[
    \pderiv{}{x_{i}} \colon \Fdif{U} \to \Fdif{U}
  \]
\end{note}

\begin{lemma}
Sea \(f\in\mathcal{F}(U\cap V)\), con \((U,\varphi),(V,\psi)\) cartas
compatibles de
\(M\) con \(U\cap V\neq\emptyset\), \(x_{i},y_{i}\) coordenadas de las cartas
respectivas. Entonces:
\[
  \Restrict{\pderiv{f}{y_{i}}}{p} =
  \Sum{\Restrict{\pderiv{f}{x_{j}}}{p} \cdot
    \Restrict{\pderiv{{(\varphi\circ\psi^{-1})}_{j}}{y_{i}}}{\psi(p)}}{j,1,m}
\]
\end{lemma}

\section{Extensión de funciones diferenciables}

\begin{lemma}
La función \[\alpha \colon \RealSet\to\RealSet\]
\[\alpha(t) =
\begin{dcases}
0 & t \leq 0 \\
e^{-1/t} & t > 0
\end{dcases}
\]
es diferenciable.
\end{lemma}
\begin{proof}

Claramente, la función es diferenciable en \(\RealSet\setminus\{0\}\). Por ello,
sólo necesitamos ver que todas las derivadas de \(\alpha\) existen y son
continuas en el origen.

Comenzaremos observando que \(\alpha\) es continua en el origen pues
\(\lim_{t\to 0}e^{-1/t}=0\). De hecho, aplicando \emph{l'Hôpital} y haciendo
inducción, se comprueba que para todo entero \(k\geq 0\),
\[
(1)\quad \lim_{t\to 0}\frac{e^{-1/t}}{t^{k}}=\lim_{t\to 0}\frac{t^{-k}}{e^{1/t}}=0.
\]

Además, se comprueba, también por inducción que la \(k\)-ésima derivada de
\(\alpha\) es de la forma:
\[
(2)\quad \alpha^{(k)}(t)=\frac{p_{k}}{t^{2k}}e^{-1/t}
\]
para algún polinomio \(p_{k}\). De \((1)\) y \((2)\) obtenemos que
\[
(3)\quad \lim_{t\to 0}\alpha^{(k)}(t)=0.
\]
Finalmente, deducimos que \(\alpha^{(k)}(0)=0\) para todo \(k\geq 0\):

Para \(k=0\) es cierto por definición. Asumimos que lo es para \(k\geq 0\). Es
suficiente probar que \(\alpha\) tiene derivadas unilaterales desde ambos lados
y son iguales. Claramente, desde el lado izquierdo, la derivada es \(0\). Usando
\((1)\) otra vez, se tiene que
\[
  \alpha^{(k+1)}(0)=\lim_{t\to
    0}\frac{\alpha^{(k)}(t)-\alpha^{(k)}(0)}{t-0}=\lim_{t\to
    0}\frac{p_{k}(t)}{t^{2k+1}}e^{-1/t}=0.
\]
Por \((3)\), esto implica que cada \(\alpha^{(k)}\) es continua, luego es
diferenciable.
\end{proof}

\begin{lemma}[extensión en \(\RealSet^{n}\)]
  \label{lem:ext-lambda}
  \(\exists \lambda \colon \RealSet^{n}\to\RealSet\) diferenciable tal que
  \[
    \lambda(x) =
    \begin{dcases}
      1 & \Norm{x} \leq 1 \\
      \lambda(x)\in(0,1) & 1<\Norm{x}<2 \\
      0 & \Norm{x} \geq 2
    \end{dcases}
  \]
\end{lemma}
\begin{proof}
  Sea \(\beta(t)=\alpha(t-1)\cdot\alpha(2-t),\quad
  \beta\colon\RealSet\to\RealSet\), tal que:
  \[
    \beta(t)=
    \begin{dcases}
      0 & t\leq 1\equiv\alpha(t-1\leq 0)=0 \\
      0 & t\geq 2\equiv\alpha(2-t\leq 0)=0 \\
      0<\beta(t)<1 & 1<t<2
    \end{dcases}
  \]

  Sea \(\tau\colon\RealSet\to\RealSet\), tal que:
  \[
    \tau(s)=\frac{\int_{s}^{\infty} \beta(t) \cdot dt}{\int_{-\infty}^{\infty}\beta(t) \cdot dt}\overset{\beta(t\not\in(1,2))=0}{=}
           \frac{\int_{s}^{2} \beta(t) \cdot dt}{\int_{1}^{2} \beta(t) \cdot dt}=
  \]
  \[
    =\begin{dcases}
      0 & s\geq 2 \\
      1 & s\leq 1 \\
      0<\tau(s)<1 & 1<s<2
     \end{dcases}
  \]
  \[
    \longrightarrow \begin{array}{c}
                      \lambda\colon\RealSet^{n}\to\RealSet \\
                      \lambda(x)=\tau(\Norm{x})
                     \end{array} 
  \]
   
\end{proof}

\begin{lemma}
  \label{lem:ext-exists-vi}
  Sea \(M\) \hyperref[def:vd]{variedad}.
  Dados \(p \in M\) y un abierto \(U \subseteq M\) con \(p \in U\),
  existen abiertos \(V_{1} \subseteq V_{2} \subseteq V_{3} \subseteq U\)
  con \(\Clausura{V_{1}} \subseteq V_{2} \subseteq \Clausura{V_{2}} \subseteq
  V_{3}\)
  y una función diferenciable \(\mu \colon M \to \RealSet\) con
  \(\Restrict{\mu}{\Clausura{V_{1}}} = 1\), \(0 < \mu(q) \leq 1\) si \(q \in
  V_{2} \setminus \Clausura{V_{1}}\) y \(\Restrict{\mu}{M \setminus V_{2}}=0\)
\end{lemma}

\begin{proof}
  Sea \(p \in U\). Entonces existe \((V,\varphi)\) una carta con \(p \in V
  \subseteq U\) y \(\varphi(V) = \RealSet^{m}\) con \(\varphi(p)=0\).
  Sean \(\Omega_{1} \subseteq \Omega_{2} \subseteq \Omega_{3} \RealSet^{m}\)
  bolas abiertas de radio \(1,2,3\) respectivamente.

  Sean \(V_{i} \coloneqq \varphi^{-1}(\Omega_{i})\).
  Son abiertos de \(M\).
  Además \(\varphi \colon V \to \varphi(V) = \RealSet^{m}\).
  \(\varphi\left( \Clausura[V]{V_{i}} \right) = \Clausura{\Omega_{i}}\), que es
  bola cerrada y compacta, luego \(\Clausura[V]{V_{i}}\) es compacto, luego es
  cerrado en \(M\) y \(V_{i} \subseteq \Clausura[V]{V}\), luego
  \(\Clausura[M]{V_{i}} \subseteq \Clausura[M]{\Clausura[V]{V}} =
  \Clausura[M]{V}\).
  Además, siempre tenemos que \(\Clausura[V]{V_{i}} \subseteq
  \Clausura[M]{V_{i}}\), luego se da la igualdad.

  Aplicando el lema de \nameref{lem:ext-lambda}, existe
  \begin{align*}
    \lambda \colon \RealSet^{m} &\to \RealSet\\
    \lambda(x) &=
                 \begin{cases}
                   1 & x \in \Clausura{\Omega_{1}}\\
                   0 & x \in \RealSet^{m} \setminus \Omega_{2}
                 \end{cases}
  \end{align*}

  También definimos:
  \begin{align*}
    \mu \colon M &\to \RealSet\\
    \mu(q) &=
             \begin{cases}
               \lambda(\varphi(q)) & q \in V_{3}\\
               0 & q \in M \setminus \Clausura{V_{2}}
             \end{cases}
  \end{align*}

  \(\mu\) es diferenciable % NEEDS REF
  y cumple las propiedades del enunciado.
\end{proof}

\begin{lemma}[lema de extensión]
  Sea \(M\) una \nameref{def:vd} y \(U \subseteq M\) un abierto con \(p \in U\).
  Sea \(f \colon U \to \RealSet^{n}\) diferenciable.
  Entonces existen abiertos \(V_{i}\) con
  \(V_{1} \subseteq \Clausura{V_{1}} \subseteq V_{2} \subseteq \Clausura{V_{2}}
  \subseteq V_{3} \subseteq U\)
  de forma que existe \(\widetilde{f} \colon M \to \RealSet\) diferenciable con
  \(\widetilde{f} = f\) en \(V_{1}\) y \(\widetilde{f}=0\) en \(M \setminus
  V_{2}\).
\end{lemma}

\begin{proof}
  Sean los \(V_{i}\) del \cref{lem:ext-exists-vi}. Se define
  \begin{align*}
    \widetilde{f} \colon M &\to \RealSet\\
    \widetilde{f}(q) &=
                       \begin{cases}
                         \mu(q) \cdot f(q) & q \in V_{3}\\
                         0 & q \in M \setminus \Clausura{V_{2}}
                       \end{cases}
  \end{align*}

  Si \(q \in \Clausura{V_{1}}\), entonces \(\mu(q) = 1\), luego
  \(\widetilde{f}(q) = f(q)\).

  Si \(q \in V_{3} \setminus \Clausura{V_{2}}\), entonces \(\mu(q)=0\), luego
  \(\widetilde{f}(q)=0\), así que está bien definida y ya hemos probado el
  resultado.
\end{proof}

\section[Rango e inmersiones]{Rango de una aplicación diferenciable. Inmersiones y submersiones.}
\label{sec:rango-inmersion}

\subsection[Rango]{Rango de una aplicación diferenciable}
\label{sec:rango}



\begin{definition}[rango]
  Sea \(f \colon M \to N\) una aplicación diferenciable en \(p \in M\). Por ser
  \(f\) diferenciable, podemos encontrar cartas \((U,\varphi)\) y \((W,\psi)\)
  de \(M\) y \(N\) respectivamente con \(p \in U\), \(f(U) \subseteq W\) y
  \(\widetilde{f} \coloneqq \psi \circ f \circ \varphi^{-1} \colon \varphi(U)
  \to \psi(W)\) diferenciable en \(\varphi(p)\).

  Se llama \emph{rango} de \(f\) en \(p\), notado \(\rango{f(p)}\), al rango del
  determinante de la matriz jacobiana \(n \times m\) (se trabaja por columnas),

  \begin{equation}
    \label{eq:def-rango}
    \J[\varphi(p)]{\widetilde{f}} =
    {\left(
      \Restrict{\pderiv{{(\psi \circ f \circ \varphi^{-1})}_{i}}{x_{j}}}{\varphi(p)}
    \right)}_{\substack{1 \leq i \leq n\\\\1 \leq j \leq m}}
  \end{equation}
\end{definition}

\begin{lemma}
  Este rango no depende de las cartas elegidas.
\end{lemma}

\begin{proof}
  Si \((\Omega,\rho)\) y \((V,\xi)\) son otras cartas con \(p \in \Omega\),
  \(f(\Omega) \subseteq V\) y \(\xi \circ f \circ \rho^{-1}\) diferenciable en
  \(\rho(p)\), entonces \(f(\Omega \cap U) \subseteq V \cap W\) y, por
  compatibilidad,

  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      \varphi(U) \ar[rr, "\psi \circ f \circ \varphi^{-1}"] &&
      \psi(W) \\
      \varphi(\Omega \cap U) \ar[u, symbol=\subseteq] \ar[rr, "\psi \circ f \circ
      \varphi^{-1}"] \ar[d, "\rho \circ \varphi^{-1}"'] &&
      \psi(W \cap V) \ar[u, symbol=\subseteq] \ar[d, "\xi \circ \psi^{-1}"]\\
      \rho(\Omega \cap U) \ar[rr, "\xi \circ f \circ \rho^{-1}"] \ar[d,
      symbol=\subseteq] &&
      \xi(W \cap V) \ar[d, symbol=\subseteq]\\
      \rho(\Omega) \ar[rr, "\xi \circ f \circ \rho^{-1}"] &&
      \xi(V)
    \end{tikzcd}
    \caption{Cambio de cartas}
    \label{fig:rango-indep-carta}
  \end{figure}

  Por la regla de la cadena y la conmutatividad del diagrama, tenemos:
  \[
    \underbracket{\J[\psi f(p)]{(\xi \psi^{-1})}}_{A}
    \cdot
    \J[\varphi(p)]{(\psi f \varphi^{-1})}
    =
    \J[\rho(p)]{(\xi f \rho^{-1})}
    \cdot
    \underbracket{\J[\varphi(p)]{(\rho \varphi^{-1})}}_{B}
  \]

  Como \(A\) y \(B\) tienen rango máximo, los rangos de las matrices restantes
  son iguales.
\end{proof}

\begin{theorem}[teorema de la función inversa]\label{thm:inversa}
  Sean \(f \colon M^{n} \to N^{n}\) diferenciable entre variedades de la misma
  dimensión. Supongamos que para \(p \in M\), \(\rango{f(p)} = n\). Entonces
  existe \(\Omega\) abierto de \(M\) tal que \(p \in \Omega\), \(f(\Omega)\) es
  abierto de \(N\) y la aplicación \(f \colon \Omega \to f(\Omega)\) es
  difeomorfismo.
\end{theorem}

\begin{proof}
  Por ser \(f\) diferenciable, existen \((U,\varphi),\ (W,\psi)\) cartas de
  \(M\) y \(N\) respectivamente con \(p \in U\), \(f(U) \subseteq W\) y
  \(\widetilde{f}\) diferenciable. Se tiene el diagrama de la
  \cref{fig:factorizacion-diferenciable}. Por definición, \(\rango{f(p)} =
  \rango{\J[\varphi(p)]{\widetilde{f}}} = n\).

  Por el teorema de la función inversa en \(\RealSet^{n}\), existe \(G
  \subseteq \varphi(U)\) abierto tal que \(\widetilde{f}(G)\) es abierto de
  \(\psi(W)\). Se tiene el siguiente diagrama:

  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      \varphi^{-1}(G) \ar[r, "f"] \ar[d, "\varphi"]&
      f(\varphi^{-1}(G))
      = \psi^{-1}(\widetilde{f}(G))
      \nphantom{\(= \psi^{-1}(\widetilde{f}(G))\)}
      \ar[d, "\psi"]\\
      G \ar[r, "\widetilde{f}"] & \widetilde{f}(G)
    \end{tikzcd}
    \caption{Teorema de la función inversa}
    \label{fig:func-inv}
  \end{figure}

  Así, \(\Omega = \varphi^{-1}(G)\) y hemos terminado.
\end{proof}

\subsection{Inmersiones y submersiones}
\label{sec:inmersiones}

\begin{definition}[inmersión]
  \label{def:inmersión}
  Una aplicación diferenciable \(f \colon M \to N\) se dice que es una
  \emph{inmersión} en \(p \in M\) si \(\rango{f(p)} = \dim M\). Igualmente se
  dice una \emph{submersión} en \(p\) si \(\rango{f(p)} = \dim N\).
\end{definition}

\begin{note}
  Si \(f\) es \emph{inmersión} en \(p\), entonces \(\dim M \leq \dim N\). Si
  \(f\) es \emph{submersión} en \(p\), entonces \(\dim N \leq \dim M\).
\end{note}

\begin{theorem}[coordenadas adaptadas]
  Si \(f\) es una \nameref{def:inmersión} en \(p\), entonces existen cartas
  \((U,\varphi)\) de \(p\) y \((V,\psi)\) de \(f(p)\) verificando el diagrama
  conmutativo de la \cref{fig:inmersion-cd}, con \(m =
  \dim M\) y \(n = \dim N\). Es decir, realmente \(f\) se comporta alrededor de
  \(p\) como la inclusión canónica \(x \mapsto (x,0)\).

  \begin{figure}[h]
    \centering
    \begin{tikzcd}[column sep = large, row sep = scriptsize]
      U \ar[r, "f"] \ar[d, "\varphi"']&
      V \ar[d, "\psi"]\\
      \varphi(U) \ar[r, dashed, "\psi \circ f \circ \varphi^{-1}"']
      \ar[d, symbol=\subseteq]&
      \psi(V)
      \ar[d, symbol=\subseteq]\\
      \RealSet^{m} \ar[r, hook]&
      \RealSet^{n} = \RealSet^{m} \times \RealSet^{n-m}%
      \nphantom{\(= \RealSet^{m} \times \RealSet^{n-m}\)}\\
      x \ar[r, mapsto] & (x,0)
    \end{tikzcd}
    \caption{Inmersión}
    \label{fig:inmersion-cd}
  \end{figure}
\end{theorem}

\begin{proof}
  De acuerdo con el \cref{lem:dif-caract-exists},
  podemos elegir cartas \((U,\varphi)\) y \((V,\psi)\) con \(p \in U\) y \(f(U)
  \subseteq V\). Podemos suponer que \(\varphi(p)=0=\psi(f(p))\). Ahora
  consideramos \(\widetilde{f} = \psi \circ f \circ \varphi^{-1}\), la misma de
  la \cref{fig:factorizacion-diferenciable}.

  Si \(f\) es una \nameref{def:inmersión} en \(p\), entonces \(\rango{f(p)} =
  m\). Elegimos \(i_{1},\dots,i_{m} \in \Set{1,\dots,n}\) tales que el menor \(m
  \times m\) de la matriz jacobiana \(\left( \pderiv{\widetilde{f}_{i}}{x_{j}}
  \right)\) tiene determinante no nulo.

  \[
    \J[1]{\widetilde{f}} =
    \begin{pmatrix}
      \pderiv{\widetilde{f}_{i_{1}}}{x_{1}} & \cdots &
      \pderiv{\widetilde{f}_{i_{1}}}{x_{m}}\\
      \vdots & \ddots & \vdots\\
      \pderiv{\widetilde{f}_{i_{m}}}{x_{1}} & \cdots &
      \pderiv{\widetilde{f}_{i_{m}}}{x_{m}}
    \end{pmatrix}
  \]

  Con el fin de simplificar la notación podemos suponer \(i_{k} = k\) para todo
  \(1 \leq k \leq m\). Si no, hacemos una permutación de coordenadas en
  \(\RealSet^{n}\) adecuada y la componemos con \(\psi\) para crear una carta
  con la propiedad deseada.

  Ahora consideramos una nueva función
  \(\widetilde{F} \colon \underbracket{\varphi(U)}_{\subseteq \RealSet^{m}}
  \times \RealSet^{n-m}\) dada por
  \begin{multline*}
    \widetilde{F}(x_{1},\dots,x_{m},y_{1},\dots,y_{n-m}) =
    (\widetilde{f}_{1}(x),\dots,\widetilde{f}_{m}(x),\\
    \widetilde{f}_{m+1}(x)+y_{1},\dots,
    \widetilde{f}_{n}(x)+y_{n-m})
  \end{multline*}
  
  Entonces el jacobiano de \(\widetilde{F}\) en \((\varphi(p),0)\) es
  \[
    \J[(\varphi(p),0)]{\widetilde{F}} =
    \begin{pmatrix}
      \J[1]{\widetilde{f}} & 0 \\
      \J[2]{\widetilde{f}} & I
    \end{pmatrix}
  \]
  donde
  \begin{align*}
    \J[1]{\widetilde{F}} &= {\left( \pderiv{\widetilde{f}_{i}}{x_{j}}
    \right)}_{\substack{1 \leq i \leq m\\\\1 \leq j \leq m}}
    \J[2]{\widetilde{F}} &= {\left( \pderiv{\widetilde{f}_{i}}{x_{j}}
    \right)}_{\substack{m+1 \leq i \leq n\\\\1 \leq j \leq m}}
  \end{align*}

  Por el teorema de la función inversa en \(\RealSet^{n}\), existe \(\Omega\) un
  abierto de \(\varphi(U) \times \RealSet^{n-m}\) tal que \((\varphi(p),0) \in
  \Omega\), \(\widetilde{F}(\Omega)\) es abierto de \(\RealSet^{n}=\psi(V)\) y
  \(\widetilde{F} \colon \Omega \to \widetilde{F}(\Omega)\) es difeomorfismo.
% CHECK FROM HERE
  Sea \(V_{0} \coloneqq \psi^{-1}(\widetilde{F}(\Omega)) \subseteq V\).
  Sea \(\psi_{0} = \widetilde{F}^{-1} \circ \psi\).
  Entonces \((V_{0},\psi_{0})\) es carta de \(N\). En efecto:
  \begin{figure}[h]
    \centering
    \begin{tikzcd}[row sep=large, column sep=large]
      V_{0} \ar[d, "\Restrict{\psi}{V_{0}}"']\ar[r, "\psi_{0}"]&
      \Omega \ar[dl, dashed, "\widetilde{F}"]\\
      \widetilde{F}(\Omega) \ar[ur, dashed, "\widetilde{F}^{-1}", shift right=2]
    \end{tikzcd}
  \end{figure}

  Sea \(U_{0} \coloneqq U \cap f^{-1}(V_{0})\) abierto. Se tiene el siguiente
  diagrama:
  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      U_{0} \ar[d, "\varphi_{0} = \Restrict{\varphi}{U_{0}}"'] \ar[r, "f"]&
      V_{0} \ar[d, "\psi_{0} = \widetilde{F}^{-1} \circ \psi"]\\
      \varphi(U_{0}) \ar[r, dashed, "\psi_{0} \circ f \circ \varphi^{-1}"]
      \ar[d, symbol=\subseteq]&
      \Omega \ar[r, "\widetilde{F}"]
      \ar[d, symbol=\subseteq]&
      \widetilde{F}(\Omega)\\
      \RealSet^{m} &
      \psi(V) = \RealSet^{n} \nphantom{\(= \RealSet^{n}\)}
    \end{tikzcd}
  \end{figure}

  Entonces

  \[
    \psi_{0} \circ f \circ \varphi_{0}^{-1} (x_{1},\dots,x_{n}) =
    \widetilde{F}^{-1} \circ \underbracket{\psi \circ f \circ
      \varphi^{-1}}_{\widetilde{f}} = (x_{1},\dots,x_{n},0,\dots,0)
  \]
% TODO
\end{proof}

\section[Medida e invarianza]{Conjuntos de medida nula en variedades. Invarianza de la dimensión.}
\label{sec:medida-invarianza}

\begin{definition}[medida nula]\label{def:med-nula-var}
	Un conjunto \(A \subseteq \RealSet^n\) se dice de medida nula si \(\forall
  \varepsilon>0\) existen \(\Set{C_i}_{i \geq 1}\) cubos de \(\RealSet^n\) tal
  que \(A \subseteq \bigcup_{i=1}^{\infty} C_{i}\) y
  \(\Sum{vol(C_i)}{i,1,\infty} < \varepsilon\).
\end{definition}

\begin{note}
  En adelante, llamaremos \(m(A)\) a la medida de un conjunto \(A \subseteq
  \RealSet^{n}\). Recordemos que \(m \colon \Parts{\RealSet^{n}} \to \RealSet^{+}
  \cup \Set{0}\).
\end{note}

\begin{lemma}\label{lem:prop-med-var}\item
	\begin{enumerate}[label={(\arabic*)}]
		\item Si \(A\subseteq B\) y \(m(B)=0\), entonces \(m(A)=0\).\label{lem:prop-med-var.1}
		\item Si \(A=\bigcup_{n=1}^\infty A_n\) y \(m(A_n)=0\), entonces
      \(m(A)=0\). \label{lem:prop-med-var.2} 
		\item Si \(f\colon\RealSet^n\to \RealSet^n\) es diferenciable y
      \(A\subseteq\RealSet^n\) con \(m(A)=0\), entonces
      \(m(f(A))=0\). \label{lem:prop-med-var.3}
	\end{enumerate}
\end{lemma}

\begin{proof}\item
  \begin{subproof}[\ref{lem:prop-med-var.1}]
    Daremos por conocido este resultado básico de teoría de la medida.
  \end{subproof}
  
  \begin{subproof}[\ref{lem:prop-med-var.2}]
    Dado \(\varepsilon>0\) tenemos que \(\forall j \geq 1,\ A_{j} \subseteq
    \bigcup_{i=1}^{\infty} C_{i}^{j}\) con \(\Sum{vol(C_{i}^{j})}{i,1,\infty}
    < \frac{\varepsilon}{2^j}\). Entonces
    \begin{align*}
      A &\subseteq \bigcup_{j=1}^\infty \bigcup_{i=1}^\infty C_{i}^{j},
      & \Sum{\Sum{vol(C_{i}^{j})}{i,1,\infty}}{j,1,\infty}
      &< \Sum{\frac{\varepsilon}{2^j}}{j,1,\infty} = \varepsilon
    \end{align*}
  \end{subproof}
  
  \begin{subproof}[\ref{lem:prop-med-var.3}]
    Dados \(x,y\in \RealSet^{n}\) consideramos la función asociada
    \begin{align*}
      h_i\colon [0,1] &\to \RealSet\\
      t &\mapsto  f_{i}({(1-t)}x + t y)
    \end{align*}
    Es claro que \(h\) es derivable y el teorema del valor medio nos dice que
    existe un \(t_i\in [0,1]\) con \(h_i'(t_i)=h_i(1)-h_i(0)=f_i(y)-f_i(x)\).
    Además si llamamos \(w_i = (1-t_i) x -t_{i} y\), llegamos a
    \begin{align*}
      h_i'(t_i)= & \sum_{j=1}^{n}\pderiv{f_i}{x_j}(w_i)\Restrict{\D{((1-t)x_j+ty_j)}{t}}{t=t_i}\\
                 & =\sum_{j=1}^{n}\pderiv{f_i}{x_j}(w_i)(y_j-x_j)
    \end{align*}
    
    Por tanto \(f_i(y)-f_i(x)=\sum_{j=1}^{n}\pderiv{f_i}{x_j}(w_i)(y_j-x_j)\).
    Así pues, si \(x,y\) están en un conjunto \(\Gamma\) convexo y compacto se
    cumple
    \begin{align*}
      \Norm{f(x)-f(y)} &\leq K \Norm{y-x}
      & K &\geq \max_{\substack{x\in \Gamma \\ 1 \leq i,j \leq n}}
      \Norm*{\pderiv{f_i}{x_j}(x)}
    \end{align*}
    
    Si aplicamos el \hyperref[lem:prop-med-var.2]{lema 2.13.2}, podemos
    suponer que \(A\subseteq \Gamma\). Si \(A\subseteq \bigcup_{s=1}^\infty
    C_s\), siendo \(C_s\) cubos de volumen \(\sqrt{s}\) con
    \(\Sum{v_{s}}{s,1,\infty} <\frac{\varepsilon}{K^n}\).
    
    Sea \(l_s\) el lado del cubo \(C_s\) y \(y_s\) su centro, todo punto
    cumple
    \[
      \Norm{y_{s}-x}\leq \frac{\sqrt{n}l_{s}}{2}
    \]
    y por tanto, los puntos de \(f(A\cap C_{s})\) están contenidos en los
    cubos \(C_{s}'\) de centro \(f(y_{s})\), lado \(Kl_{s}\) y volumen
    \(K^{n}l_{s}^{n}=K^{n}v_{s}\). Entonces \(\sum_{s=1}^{\infty}
    vol(C_s')=K^n\sum_{s=1}^{\infty}v_s<\varepsilon\).
  \end{subproof}
\end{proof}

Ahora extenderemos el concepto de conjunto de medida nula a variedades.

\begin{definition}[variedad de medida nula]\label{def:var-med-nula}
  Sea \(M\) una m-variedad, decimos que \(A\subseteq M\) tiene \emph{medida
    nula} si para toda carta \((U,\varphi)\) de \(M\) se tiene que
  \(\varphi(A\cap U)\) tiene medida nula en \(\RealSet^m\).
\end{definition}

Después de esta definición completamente natural tenemos un resultado directo:

\begin{lemma}\label{lem:denso}
  Si \(A\subseteq M\) es una \nameref{def:var-med-nula}, entonces \(M-A\) es
  denso en \(M\).
\end{lemma}

\begin{proof}
  Por reducción al absurdo: supongamos que existe un \(x \notin \Clausura{M-A}\)
  y \((U,\varphi)\) una carta con \(x\in U\subseteq M-\Clausura{M-A}\). Destacar
  que este conjunto es un abierto en \(M\) dado que le estamos quitando un
  cerrado y de hecho es el \(\Interior{A}\) por su propia construcción.
  
  Entonces \(\varphi(A\cap U)=\varphi(U)\) es abierto de \(\RealSet^m\) con
  medida nula, pero esto es una contradicción pues contiene un cubo \(D\) de un
  cierto volumen \(\delta\) y si \(D\subseteq \bigcup_{s=1}^\infty C_s\) con
  \(\sum_{s=1}^{\infty}vol(C_s)<\frac{\delta}{2}\) tendríamos que
  \(\delta=vol(D)\leq \sum_{s=1}^{\infty}vol(C_s)<\frac{\delta}{2}\).
\end{proof}

Ahora podemos ampliar las variedades de medida nula al aplicarles una cierta función diferenciable.

\begin{lemma}\label{lem:med-eqdim}
  Si \(f\colon M \to N\) es diferenciable con \(\dim(N)=\dim(M)\) y \(A\subseteq
  M\) tiene medida nula, entonces \(f(A)\) tiene medida nula en \(N\).
\end{lemma}

\begin{proof}
Sea \( (W,\psi) \) una carta de \( N \). Para cada \( p\in f^{-1}(f(A)\cap M) \) elegimos una carta \( (U_p,\varphi_p) \) con \( f(U_p)\subseteq W \) y \( \psi \circ f\circ \varphi^{-1}_p\colon \varphi_p(U)\to \psi(W) \) diferenciable (por ser composición de funciones diferenciables). 
Sea \( \{U_s,\varphi_s\} \) una cantidad numerable de las cartas definidas anteriormente cumpliendo \(   f^{-1}(f(A)\cap M) \subseteq \bigcup_{s=1}^\infty\)

Entonces cada \( \varphi_s(U_s\cap A)\subseteq A \) \nameref{def:var-med-nula} y por tanto si componemos \( \psi(f(\varphi^{-1}_s(\varphi_s(U_s\cap A)))) =\psi(f(\varphi_s(U_s\cap A)))\) tiene medida nula en \( \psi(W) \) y también lo tendrá \( \bigcup_{s=1}^\infty \psi(f(\varphi_s(U_s\cap A))) \).

Por construcción \( \psi(f(A)\cap W	) \subseteq  \bigcup_{s=1}^\infty
\psi(f(\varphi_s(U_s\cap A)))\) y aplicando de forma directa el \cref{lem:prop-med-var} tenemos \( m(\psi(f(A)\cap W))=0 \) y \( f(A) \) tiene medida nula.
\end{proof}

Como consecuencia de lo anterior tenemos un resultado similar de acotación sobre variedades.

\begin{proposition}\label{prop:med-ldim}
	Sea \( f\colon M\to N \) una aplicación diferenciable con \( m=\dim (M) < \dim (N)=n \). Entonces \( f(M) \) tiene medida nula sobre \( N \).
\end{proposition}

\begin{proof}
Sea \( V=M\times \RealSet ^{n-m} \) y \( g\colon V \overset{\pi}{\to}
M\overset{f}{\to} N\) donde \( \pi \) es la proyección. De acuerdo con el \cref{lem:med-eqdim} la medida de \( g(V)=f(M) \) que es nula.
\end{proof}

\begin{proposition}\label{prop:med-iso}
Si \( f\colon M\to N \) es diferenciable, sobreyectiva y \( df_p \) es inyectiva, entonces \( df_p \) es isomorfismo.
\end{proposition}

\begin{proof}
Por la \cref{prop:med-ldim} y el \cref{lem:denso} tenemos que \( \dim (M) \geq \dim (N) \). Como siempre ocurre la otra desigualdad nos queda \( \dim (M)=\dim (N) \) y por tanto \( df_p \) es isomorfismo.
\end{proof}

\begin{proposition}\label{prop:med-difeo}
Si \( f\colon M\to N \) ds una inmersión biyectiva en cada \( p\in M \), entonces \( f \) es un difeomorfismo.
\end{proposition}

\begin{proof}
Estamos en las condiciones de la \cref{prop:med-iso} por lo que ya sabemos que \( df_p \) es isomorfismo. Por el \nameref{thm:inversa}
para cada punto \( p\in M \) se cumple que \( f\colon U_p\to f(U_p) \) es un difeomorfismo para cierto abierto \( p\in U\subseteq M \).

Por tanto \( f^{-1}\colon N\to M \) es diferenciable pues \( \forall q\in N \) \( f^{-1}\colon f(U_p)\to U_p \) lo es si hacemos \( p=f^{-1}(q) \).
\end{proof}

\begin{note}
De los resultados anteriores se deduce que dos variedades difeomorfas tienen necesariamente la misma dimensión, ya que si razonásemos por reducción al absurdo tendríamos \( f\colon M \to N \) difeomorfismo con \( \dim (M) < \dim (N) \) y como hemos visto \( f(M)=N \) ambos de medida nula, lo que contradice el \cref{lem:denso}.
\end{note}

\section{Ejercicios Interesantes de la Relación 2}

\begin{Exercise}[number=16,label={ex:2.16}]
  Sean \(E,\, B\) y \(F\) variedades diferenciables. Una aplicación
  diferenciable \(\pi\colon E\to B\) se llama \emph{fibración} si para cada
  \(p\in B\) existen un abierto \(U\subseteq B\) con \(p\in U\) y un
  difeomorfismo \(\rho_{U}\colon\pi^{-1}(U)\to U\times F\) tal que el diagrama
  % (0.0.1)   \pi^{-1}(U)--\rho_{U}-->U\times F
  %                   -   -  \pi  -  -    \pi_{1}      
  %                                 ->   U
  es conmutativo, donde \(\pi_{1}\) denota la primera proyección. Los
  difeomorfismos \(\rho_{U}\) son llamados \emph{trivializaciones} de \(\pi\)
  y a la variedad \(F\) se le llama la \emph{fibra} de \(\pi\). Las variedades
  \(B\) y \(E\) se llaman \emph{espacio base} y \emph{espacio total} de la
  fibración, respectivamente.

  \begin{enumerate}
    \item Probar que podemos encontrar un atlas \(\mathcal{A}\) de \(B\) tal que
      para cada carta \((U,\varphi)\) de \(\mathcal{A}\) se tiene un diagrama
      análogo a (0.0.1).
    \item Probar que toda fibración es una submersión. Probar que la restricción
      a \(\RealSet^{2}\setminus\{(0,0)\}\) de la proyección
      \(\pi_{2}\colon\RealSet^{2}\to\RealSet\) es una submersión pero no es una
      fibración.
    \item Probar que \(f\colon\RealSet\to S^{1}\) dada por
      \(f(t)=(\cos{t},\sin{t})\)
      es una fibración de fibra \(\IntegerSet\).
    \item Probar que la proyección \(\pi\colon S^{n}\to P_{n}\RealSet\) es una
      fibración de fibra la \(0\)-variedad \(\{\pm 1\}\).
    \end{enumerate}
\end{Exercise}

\begin{Answer}[number=16]
  1. \(\forall p\in B,\, \exists U_{p}\ni p\) cumpliendo el dicho diagrama
  conmutativo. Entonces \(\exists(V_{p},\varphi_{p})\) carta con \(p\in
  V_{p}\subseteq U_{p}\) (abierto) cumpliendo:
% \begin{figure}[h]
%    \centering
%    \begin{tikzcd}
%      \pi^{-1}(V_{p}) \ar[rr, "\rho_{V_{p}}"]\ar[rd, "\pi"] &&
%      V_{p}\times F \ar[ld, "\pi_{1}"] \\
%      U 
%    \end{tikzcd}
%    \caption{Diagrama Conmutativo}
%  \end{figure}

%   \begin{figure}[h]
%    \centering
%    \begin{tikzcd}
%      \pi^{-1}(V_{p}) \ar[r,"\rho"] \ar[dr, "\pi"'] &
%      U\times F \ar[d, "\pi_{1}"] \\
%      & U
%    \end{tikzcd}
%    \caption{Diagrama Conmutativo}
%  \end{figure}
  
  Como \(\rho_{_{V_{p}}}\) es difeomorfismo en \(U_{p}\), su restricción a
  \(V_{p}\) también lo es. Por la \cref{def:Lindelöff},
  \(B=\bigcup_{p\in B}V_{p}\). Entonces \(\exists\) una cantidad numerable
  cubriendo \(B\) y \({(V_{p},\varphi_{p})\colon p\in B}\) es el atlas que buscábamos.

  2. \(U\) tiene estructura diferenciable y además cumple el diagrama
  conmutativo de la hipótesis, donde observamos que \(\pi_{1}\) es una submersión (es
  la primera proyección). Sea \(p\in B\), entonces existen cartas
  \((W,\varphi)\) de \(U\) (de \(B\)) y \((V,\psi)\) de \(\pi^{-1}(U)\) (de
  \(E\)) tal que:

%  \begin{figure}[h]
%    \centering
%    \begin{tikzcd}
%      V \ar[rr,"pi"]\ar[dd,"\psi"] & W \ar[dd,"\varphi"] \\
%      \psi(V) \ar[rr] & \varphi(W)
%    \end{tikzcd}
%    \caption{Diagrama Conmutativo 2}
%  \end{figure}
  
  Como \(\varphi\circ\pi\circ\psi^{-1}\) tiene como rango la dimensión de \(B\)
  que es menor que la de \(E\), entonces \(\pi\) es submersión.

  El recíproco es falso: Sea \(\pi\colon\RealSet^{2}\backslash
  {0}\to\RealSet\) tal que \(\pi(x,y)=x\), que claramente es submersión. Por
  reducción al absurdo, si fuera fibración, \(\exists U\) abierto de
  \(\RealSet\) con \(0\in U\), \(U\) cumpliendo el diagrama del enunciado. Como
  \(p\in U\), podemos tomar el mismo diagrama cambiando \(U\) por \(p\):

  % Diagrama Conmutativo 3
  %   \pi^{-1}(p)--\rho_p-->{p}xF
  %        \               /   
  %     \pi \             / \pi_1
  %               p

  Como \(\rho_{p}\) es difeomorfismo, en particular es homeomorfismo. Por ello,
  del diagrama se obtiene que \(\{p\}\times F\homeo F\). Sin embargo, \(\pi^{-1}(0)\)
  es no conexa mientras que \(\pi^{-1}(x),\,x\neq 0\) es conexa, luego
  contradicción y \(\pi\) NO es fibración.

  3. Sea \(\pi\colon\RealSet\to S^{1},\,\pi(t)=(\cos{t},\sin{t})\). Tomaremos
  como \(U_{p}=S^{1}\backslash\{(1,0)\}\). Tal y como hicimos en otro ejercicio
  de clase, dividiremos la circunferencia en \(n\) partes de ángulo \(2\pi/n\).
  Luego \(\pi^{-1}(U_{p})=\bigcup_{k\in\IntegerSet}(2\pi k,2\pi (k+1))\). Se
  tiene que los intervalos dentro de la unión son todos homeomorfos a la recta
  real, y que su unión en los \(k\in\IntegerSet\) es difeomorfa a
  \(S^{1}\backslash\{(1,0)\}\times\IntegerSet\) por el difeomorfismo \(x\mapsto
  (\pi(x),k)\), con \(x\in (2\pi k,2\pi (k+1))\). Para el punto \((1,0)\) cojo
  \(U_{(1,0)}=S^{1}\backslash\{(-1,0)\},\,
  \pi^{-1}(U_{(1,0)})=\bigcup_{k\in\IntegerSet}(-\pi+2\pi k,\pi+2\pi k)\). Así
  que \(\pi\) es fibración de fibra \(\IntegerSet\).  
\end{Answer}

\begin{Exercise}[number=17]
Probar que \(h\colon\RealSet^{4}\backslash\{0\}\to\RealSet^{3}\backslash\{0\}\)
dada por
\[
  h(a,b,c,d)=(2(ac+bd),2(ad-bc),c^{2}+d^{2}-a^{2}-b^{2})
\]
es una submersión que envía la \(3\)-esfera de radio \(r\) en la \(2\)-esfera de radio
\(r^{2}\), por 1o que para \(r=1\) tenemos \(h\colon S^{3}\to S^{2}\).

Probar que \(h\) es de hecho una \underline{fibración} de fibra \(S^{1}\), llamada la
fibración de \underline{Hopf}.

Considerar los conjuntos
\(OZ_{+}=\{(x,y,z)\in\RealSet^{3}\backslash\{0\}: z>0\}\) y 
\(OZ_{-}=\{(x,y,z)\in\RealSet^{3}\backslash\{0\}: z<0\}\)
y las aplicaciones
\[
\psi_{+}\colon((\RealSet^{3}\backslash\{0\})\backslash OZ_{+})\times S^{1}\to
h^{-1}((\RealSet^{3}\backslash\{0\})\backslash OZ_{+})
\]
y
\[
\psi_{-}\colon((\RealSet^{3}\backslash\{0\})\backslash OZ_{-})\times S^{1}\to
h^{-1}((\RealSet^{3}\backslash\{0\})\backslash OZ_{-})
\]
dadas por
\[\begin{array}{l}
  \psi_{+}(x,y,z,(p,q))= \\
  (\sqrt{\frac{r-z}{2}}p,\sqrt{\frac{r-z}{2}}q,
  (xp-yq)\sqrt{\frac{1}{2(r-z)}},(xq+yp)\sqrt{\frac{1}{2(r-z)}})
\end{array}\]
y por
\[\begin{array}{l}
  \psi_{-}(x,y,z,(p,q))= \\
  ((xp+yq)\sqrt{\frac{1}{2(r+z)}},(xq-yp)\sqrt{\frac{1}{2(r+z)}},
  \sqrt{\frac{r+z}{2}}p,\sqrt{\frac{r+z}{2}})
\end{array}\]
donde, en ambas igualdades, \(r=\sqrt{x^{2}+y^{2}+z^{2}}\). Probar que
ambas son diferenciables con inversas
\[
\psi_{+}^{-1}(a,b,c,d)=(h(a,b,c,d),\frac{a}{\sqrt{a^{2}+b^{2}}},\frac{b}{\sqrt{a^{2}+b^{2}}})
\]
y
\[
\psi_{-}^{-1}(a,b,c,d)=(h(a,b,c,d),\frac{c}{\sqrt{c^{2}+d^{2}}},\frac{d}{\sqrt{c^{2}+d^{2}}})
\]
\end{Exercise}

\begin{Answer}[number=17]
  1. Primero vamos a probar que \(h\) es en efecto una submersión.

  Observemos primero que \(h\) es una función diferenciable pues sus 3
  componentes son polinomios. Veamos ahora que es diferenciable:

  Sea \(p\in U\), con \(U\) abierto de \(\RealSet^{4}\backslash\{0\}\),
  cualquiera. Entonces podemos encontrar una carta de mi espacio de salida
  \((V,\varphi=i_{\RealSet^{4}\backslash\{0\}}=id_{4})\) tal que \(p\in
  V\subseteq U\), y una carta de mi espacio de llegada
  \((W,\psi=i_{\RealSet^{3}\backslash\{0\}}=id_{3})\) tal que \(h(p)\in
  h(V)\subseteq W\).

  Luego tenemos el diagrama
  \begin{figure}[h]
    \centering
    \begin{tikzcd}
      V \ar[r, "h"] \ar[d, "id_4"]&
      W \ar[d, "id_3"]\\
      id_4(V)=V \ar[r, "\widetilde{h}"] & id_3(W)=W
    \end{tikzcd}
  \end{figure}

  Y \(\widetilde{h}=id_{3}\circ h\circ id_{4}^{-1}\) es diferenciable pues es
  composición de funciones diferenciables. Luego \(h\) es diferenciable y lleva
  la \(4\)-variedad \(\RealSet^{4}\backslash\{0\}\) en la \(3\)-variedad
  \(\RealSet^{3}\backslash\{0\}\).

  Para ver que es submersión debemos calcular su jacobiano (matriz \(4\times
  3\)) y ver que su rango es máximo (es decir, \(3\)):

  \[
    J_{id_{4}(p)}(id_{3}\circ h\circ id_{4}^{-1})=J_{p}(h)=
    \begin{bmatrix}
      2c & 2d & 2a & 2b \\
      2d & -2c & -2b & 2a \\
      -2a & -2b & 2c & 2d 
    \end{bmatrix}
  \]

  Si efectuamos los cálculos de todos los menores de orden \(3\), veremos que
  todos son nulos sii
  \((a,b,c,d)=(0,0,0,0)\not\in\RealSet^{4}\backslash\{0\}\). Luego el rango es
  máximo y nuestra aplicación es submersión.

  2. Sea \(E\) la \(3\)-esfera de radio \(r\) dentro de
  \(\RealSet^{4}\backslash\{0\}\). Un punto de la misma será de la forma
  \((a,b,c,\sqrt{r^{2}-a^{2}-b^{2}-c^{2}})=(a,b,c,d_{*})\). Si le aplicamos \(h\)
  nos queda:
  \[
    h(a,b,c,d_{*})=(2(ac+bd_{*}),2(ad_{*}-bc),c^{2}+d_{*}^{2}-a^{2}-b^{2})
  \]

  Y si elevamos cada componente al cuadrado y lo sumamos, obtendremos (tras unos
  cálculos) \(r^{4}\). Por tanto \(h(E)\) es una \(2\)-esfera de radio
  \(r^{2}\). Obviamente, \(h\colon S^{3}\to S^{2}\).

  3. Veamos que \(h\) es una fibración.

  Nuestro difeomorfismo (necesario para la
  fibración como vimos en el \cref{ex:2.16}) será el dado por
  \(\psi_{\pm}\) y \(\psi_{\pm}^{-1}\), para ello basta probar que es biyectiva,
  diferenciable y la inversa es diferenciable. Es fácil comprobar que lo son por
  el hecho de cómo están definidos los conjuntos de definición.

  Así, podemos encajar en el diagrama conmutativo los conjuntos
  \(h^{-1}(\RealSet^{3}\backslash\{0\}\backslash OZ_{\pm}),\,((\RealSet^{3}
  \backslash\{0\})\backslash OZ_{\pm})\times S^{1},\,((\RealSet^{3}
  \backslash\{0\})\backslash OZ_{\pm})\) (en orden de lectura) con las
  aplicaciones \(\psi_{\pm}^{-1},\, h,\, \pi_{1}\) (en sus correspondientes
  lugares). Es conmutativo por la forma en la que está definida
  \(\psi_{\pm}^{-1}\), que guarda su primera componente para la imagen por \(h\)
  del punto \((a,b,c,d)\).

  Luego \(h\) es la llamada \underline{fibración de Hopf} de fibra \(S^{1}\).
\end{Answer}

\end{document}

%%% Local Variables:
%%% TeX-master: "../VD"
%%% End: